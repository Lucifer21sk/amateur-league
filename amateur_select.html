<!DOCTYPE html>
<html lang="sk">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>V√Ωber Z√°pasu - Amat√©rska Liga</title>
  <link rel="stylesheet" href="style.css">
  <style>
      body { text-align: center; background: #f4f7f6; }
      h1 { color: #2e7d32; margin-top: 30px; } /* Changed to green for Amateur visual difference */
      
      /* LEAGUE SELECTION STYLES */
      #leagueSelection {
          margin-top: 50px;
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 20px;
      }
      .league-btn {
          background: #2e7d32;
          color: white;
          border: none;
          padding: 25px 40px;
          font-size: 24px;
          border-radius: 12px;
          cursor: pointer;
          width: 80%;
          max-width: 400px;
          font-weight: bold;
          box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      }
      .league-btn:active { background: #1b5e20; }

      /* MATCH CARDS STYLES */
      #matchSelection { display: none; }
      .match-card {
          background: white;
          padding: 20px;
          margin: 15px auto;
          border-radius: 12px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.1);
          max-width: 600px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          border-left: 6px solid #2e7d32;
          text-align: left;
      }
      .match-info { flex-grow: 1; }
      .date-badge { font-size: 0.85em; color: #666; font-weight: bold; text-transform: uppercase; margin-bottom: 5px; }
      .teams-vs { font-size: 1.4em; font-weight: bold; color: #333; }
      .start-btn {
          background: #2e7d32;
          color: white;
          text-decoration: none;
          padding: 15px 20px;
          border-radius: 8px;
          font-weight: bold;
          font-size: 1.1em;
      }
      .back-btn {
          margin-top: 20px;
          padding: 10px 20px;
          background: #ccc;
          border: none;
          border-radius: 8px;
          cursor: pointer;
          font-size: 16px;
      }
  </style>
</head>
<body>

  <h1 id="pageTitle">Amat√©rska Liga</h1>

  <div id="leagueSelection">
      <h2>Vyberte ligu:</h2>
      <button class="league-btn" onclick="selectLeague(1)">1. Amat√©rska Liga</button>
      <button class="league-btn" onclick="selectLeague(2)">2. Amat√©rska Liga</button>
  </div>

  <div id="matchSelection">
      <h2 id="selectedLeagueTitle"></h2>
      <div id="matchesContainer">Naƒç√≠tavam z√°pasy...</div>
      <button class="back-btn" onclick="goBack()">Sp√§≈• na v√Ωber ligy</button>
  </div>

  <script>
    let currentLeague = null;

    function selectLeague(leagueLevel) {
        currentLeague = leagueLevel;
        localStorage.setItem("amateurLeagueLevel", leagueLevel); // Save choice for later pages
        
        document.getElementById("leagueSelection").style.display = "none";
        document.getElementById("matchSelection").style.display = "block";
        
        document.getElementById("selectedLeagueTitle").innerText = `${leagueLevel}. Amat√©rska Liga - Dne≈°n√© z√°pasy`;
        
        loadScheduledMatches(leagueLevel);
    }

    function goBack() {
        document.getElementById("matchSelection").style.display = "none";
        document.getElementById("leagueSelection").style.display = "flex";
        document.getElementById("matchesContainer").innerHTML = "Naƒç√≠tavam z√°pasy...";
        localStorage.removeItem("amateurLeagueLevel");
    }

    async function loadScheduledMatches(leagueLevel) {
        const container = document.getElementById("matchesContainer");
        try {
            // Note: We will need to update the Python API to accept or filter by this leagueLevel
            // For now, I'm adding `?league=${leagueLevel}` to the fetch URL
            const response = await fetch(`https://Lucifer21sk.pythonanywhere.com/matches/scheduled?league=${leagueLevel}`);
            const matches = await response.json();

            const today = new Date().toISOString().split('T')[0];

            const todayMatches = matches
                .filter(m => m.date === today && !m.is_finished)
                .sort((a, b) => a.time.localeCompare(b.time));

            container.innerHTML = "";
            
            if (todayMatches.length === 0) {
                container.innerHTML = `
                    <div class='no-matches'>
                        Dnes nie s√∫ napl√°novan√© ≈æiadne z√°pasy pre t√∫to ligu.<br>
                        <small style="color:#888; font-size:0.6em;">D√°tum: ${today}</small>
                    </div>`;
                return;
            }

            todayMatches.forEach(m => {
                container.innerHTML += `
                    <div class="match-card">
                        <div class="match-info">
                            <div class="date-badge">üïí DNES | ${m.time}</div>
                            <div class="teams-vs">${m.home_team} vs ${m.away_team}</div>
                        </div>
                        <a href="attendance_home.html?match_id=${m.id}&home=${m.home_team_id}&away=${m.away_team_id}" class="start-btn">
                            ≈†tart ‚ñ∫
                        </a>
                    </div>
                `;
            });
        } catch (err) {
            container.innerHTML = "Chyba pripojenia na server.";
            console.error(err);
        }
    }
  </script>

</body>
</html>